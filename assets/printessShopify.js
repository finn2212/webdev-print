/*Printess Shopify Integration Version: 2.4*/const showPrintessEditorFallback=(t,e=0)=>{var o,r,n="openPrintessEditor"+t;void 0===window[n]?(o=document.getElementById("printess_script_"+t))&&((r=document.createElement("script")).setAttribute("id","printess_script_"+t),r.type="text/javascript",r.text=o.text,o.replaceWith(r),e<10?setTimeout(function(){showPrintessEditorFallback(t,++e)},200):console.error(n+" not found.")):window[n]()},initPrintessShopifyEditor=d=>{if(void 0===window.printessShopifyEditor){const i='button[type="submit"][name="add"], button.product-form__add-button[data-action="add-to-cart"],button#AddToCart',u={productCache:{},productFormSelector:'form[data-type="add-to-cart-form"],form.product-single__form,form.shopify-product-form[id^=product-form-template],form[action="/cart/add"]',debounce:function(e,o=300){let r=void 0;return(...t)=>{clearTimeout(r),r=setTimeout(()=>{e.apply(this,t)},o)}},getCurrentProductOptionValues:o=>{const r={};var t=u.getAddToBasketForm(u.productFormSelector);function n(t){return t=0===t.indexOf("properties[")&&t.lastIndexOf("]")===t.length-1||0===t.indexOf("options[")&&t.lastIndexOf("]")===t.length-1?t.substring(11,t.length-1):t}if(document.querySelectorAll("input[data-option-name],select[data-option-name]").forEach(t=>{var e;t.form||(e=n(t.getAttribute("data-option-name")),t=t.getAttribute("value"),0<e.length&&"_"!==e[0]&&(r[e]=t))}),t){const p=t.getAttribute("name");for(const s of new FormData(t).entries()){let e=n(s[0]);!0===d.supportsOptionPositionIndex&&document.getElementsByName(s[0]).forEach(t=>{(!p||t.getAttribute("form")===p||t.form&&t.form.getAttribute("name")===p)&&(t=parseInt(t.getAttribute("data-option-position")),!isNaN(t))&&0<t&&o&&o.options&&o.options.length>=t&&(e=o.options[t-1])}),0<e.length&&"_"!==e[0]&&(r[e]=s[1])}var i,a=t.querySelectorAll('input[type="checkbox"]');if(a&&0<a.length)for(let e=0;e<a.length;++e)if(void 0!==a[e].checked&&!0===a[e].checked){let t=n(a[e].name);0<(t=!0===d.supportsOptionPositionIndex&&(i=parseInt(a[e].getAttribute("data-option-position")),!isNaN(i))&&0<i&&o&&o.options&&o.options.length>=i?o.options[i-1]:t).length&&"_"!==t[0]&&(r[t]="true")}}return r},getOptionsLookup:e=>{var o={};if(e&&e.options)for(let t=0;t<e.options.length;++t)o[e.options[t]]=t,o["option"+(t+1)]=t;return o},getProductOptionValuesForVariants:(t,e)=>{var o=u.getOptionsLookup(e),r={};for(const n in t)t.hasOwnProperty(n)&&0<=o[n]&&(r[n]=t[n]);return r},parseInputName:t=>{var e;return t=(t=(t||"").trim())&&"]"===t[t.length-1]&&-1<(e=(t=t.substr(0,t.length-1)).indexOf("["))?t.substr(e+1):t},addVariantChangeHandler:(e,o)=>{const r=function(t){let e="";for(const o in t)t.hasOwnProperty(o)&&(e+=o+";"+t[o]+"_");return e},n=()=>{u.debounce(()=>{var t=r(u.getProductOptionValuesForVariants(u.getCurrentProductOptionValues(e),e));u.addVariantChangeHandler.lastValue!=t&&(u.addVariantChangeHandler.lastValue=t,"function"==typeof o)&&o(u.getVariantByProductOptions(u.getCurrentProductOptionValues(e),e,!0))},100)()};var t=u.getAddToBasketForm(u.productFormSelector);if(t){const i=[];t.querySelectorAll("input,select").forEach(t=>i.push(t)),document.querySelectorAll("input[form='"+t.getAttribute("id")+"'],select[form='"+t.getAttribute("id")+"']").forEach(t=>i.push(t)),i.forEach(t=>{"select"!==t.nodeName.toLowerCase()&&"radio"!==(t.getAttribute("type")||"").toLowerCase()||t.addEventListener("change",n)})}},getVariantByProductOptions:(t,e,o=!1)=>{const r=u.getProductOptionValuesForVariants(t,e);var n=u.getOptionsLookup(e);let i=e.variants;for(const a in r)if(r.hasOwnProperty(a)){let e=void 0!==n[a]&&0<=n[a]?n[a]:-1;-1<e&&(i=i.filter(t=>{if(t.options&&t.options.length>e&&t.options[e]==r[a])return!0}))}if(0===i.length){i=e.variants;for(const p in r)r.hasOwnProperty(p)&&0===p.indexOf("option")&&(i=i.filter(t=>{if(void 0!==t[p]&&t[p]===r[p])return!0}))}return 0!==i.length||o?(0===i.length?e.variants:i)[0]:null},postMessage:(t,e)=>{const o=document.getElementById("printess");o&&setTimeout(function(){o.contentWindow.postMessage({cmd:t,properties:e||{}},"*")},0)},setFormFieldValue:(n,i,a,p)=>{let t=document.querySelectorAll('input[type="radio"]');t&&0<t.length&&t.forEach(t=>{var e=u.parseInputName(t.getAttribute("data-option-name")||t.getAttribute("data-name")||t.getAttribute("name")||void 0),o=t.getAttribute("value")||void 0;e!==n&&e!==a||(o===i||o===p?(t.setAttribute("checked",(!0).toString()),t.checked=!0):(t.removeAttribute("checked"),t.checked=!1))}),t&&0!=t.length||(t=document.querySelectorAll("select")).forEach(e=>{var o=u.parseInputName(e.getAttribute("data-option-name")||e.getAttribute("data-name")||e.getAttribute("name"));if(e.options)for(let t=0;t<e.options.length;++t){var r=e.options[t].getAttribute("value");o!==n&&o!==a||(r===i||r===p?(e.options[t].setAttribute("selected",(!0).toString()),e.options[t].selected=!0,e.setAttribute("value",i),e.value=i):(e.options[t].removeAttribute("selected"),e.options[t].selected=!1))}}),(t=document.querySelectorAll('input[type="text"],input[type="color"],input[type="date"],input[type="datetime-local"],input[type="email"],input[type="month"],input[type="number"],input[type="tel"],input[type="time"],input[type="url"],input[type="week"]'))&&0<t.length&&t.forEach(t=>{var e=u.parseInputName(t.getAttribute("data-option-name")||t.getAttribute("data-name")||t.getAttribute("name")),o=t.getAttribute("value");e===n?t.setAttribute("value",o):e===a&&t.setAttribute("value",p)})},setProductProperty:(t,e,o,r,n,i=!1)=>{t.basketItemOptions||(t.basketItemOptions={});var a=i?r:e;void 0!==t.basketItemOptions[a]?t.basketItemOptions[a]=i?n:o:i?t.basketItemOptions[e]=o:u.setProductProperty(t,e,o,r,n,!0)},initProductPage:(n,i,t)=>{var e;null!==n&&(e=function(t=null,e=void 0){t=null!==t?t:u.getVariantByProductOptions(u.getCurrentProductOptionValues(i),i,!0);let o=n||"";t&&t.templateName&&(o=t.templateName);var r=window.document.getElementById("printessCustomizeButton"+i.id),t=null!==t&&!(void 0!==t.available&&!1===t.available)&&o;u.showOrHideElement({elementSelector:'button[name="add"], button.product-form__add-button[data-action="add-to-cart"],button#AddToCart'},!t,"block"),u.showOrHideElement({elementSelector:'button[type="button"].shopify-payment-button__button'},!t,"block"),r&&(r.style.display=t?"flex":"none",!0===e)&&(r.printessEditor=u)},u.addVariantChangeHandler(i,e),e(null,!0))},showOrHideElement:(e,o,r="block",n=10)=>{if(!(n<=0)){let t=void 0!==e.elementId?window.document.getElementById(e.elementId):window.document.querySelectorAll(e.elementSelector);(t=t&&void 0!==t.length?0<t.length?t[0]:null:t)?(t.originalDisplayStyle||(t.originalDisplayStyle=t.style.display||r),t.style.display=o?t.originalDisplayStyle:"none"):setTimeout(function(){u.showOrHideElement(e,o,r,n-1)},200)}},show:t=>{t=u.createShopContext(t);if("function"==typeof window.initPrintessEditor){const u=window.initPrintessEditor(d);u.show(t)}},getAddToBasketForm(t){t=document.querySelectorAll(t);if(1===t.length)return t[0];const e=document.querySelector(i);let o;return e&&t.forEach(t=>{!o&&t.contains(e)&&(o=t)}),o||t[0]},createShopContext:n=>{const r={cameFromSave:!1,lastSaveSaveToken:"",templateNameOrSaveToken:n.templateNameOrSaveToken,stickers:[],legalText:n.legalText||"",legalTextUrl:n.legalUrl||"",snippetPrices:[],chargeEachStickerUsage:!1,hidePricesInEditor:void 0!==d.hidePricesInEditor&&!0===d.hidePricesInEditor,showSplitterGridSizeButton:n.showSplitterGridSizeButton,additionalAttachParams:n.additionalAttachParams,getProductName:()=>(void 0===d.displayProductName||!1!==d.displayProductName)&&(n.product&&n.product.name)||"",getPriceInfo:()=>null,getFormFieldMappings:()=>{let t={};if(r.__ffMappings)return r.__ffMappings;if(n.optionValueMappings)try{var e=JSON.parse(n.optionValueMappings);e&&"string"!=typeof e&&"number"!=typeof e&&!Array.isArray(e)&&"boolean"!=typeof e&&"object"==typeof e&&(t=e,r.__ffMappings=t)}catch{}return t},getMergeTemplates:()=>n.mergeTemplates?"string"==typeof n.mergeTemplates?u.parseMergeTemplates(n.mergeTemplates):n.mergeTemplates:[],formatMoney:t=>{var e=d.shopMoneyFormat||"${{amount}}";return u.formatMoney(t,e)},onFormFieldChanged:(t,e,o,r)=>{void 0!==n.basketItemId?u.setProductProperty(n,t,e,o,r):u.setFormFieldValue(t,e,o,r)},onAddToBasket:(t,e)=>{void 0!==n.basketItemId?u.replaceBasketItem(n,t,e):u.addNewItemToBasket(n,t,e);try{"function"==typeof n.onAddToBasket&&n.onAddToBasket(t,e)}catch(t){console.error(t)}},getCurrentFormFieldValues:()=>u.getCurrentProductOptionValues(n.product),getPriceForFormFields:t=>{u.getProductOptionValuesForVariants(t,n.product);return u.getVariantByProductOptions(t,n.product,!0).price},getBasketId:()=>"Not yet implemented",onRenderFirstPageImage:t=>{if(r.cameFromSave&&r.lastSaveSaveToken){try{r.onSave(r.lastSaveSaveToken,t,!0)}catch(t){console.error(t)}r.cameFromSave=!1,r.lastSaveSaveToken=""}},onSave:(t,e,o=!1)=>{if(r.cameFromSave=!0,r.lastSaveSaveToken=t,o)try{"function"==typeof n.onSave&&n.onSave(t,e)}catch(t){console.error(t)}else u.postMessage("renderFirstPageImage",null)},editorClosed:t=>{t&&u.addOrRemoveTextField(u.productFormSelector,"",["printessSaveTokenEdit"+n.product.id,"printessThumbnailEdit"+n.product.id,"printessProductDefinitionIdEdit"+n.product.id,"printessOutputTypeEdit"+n.product.id,"printessDpiEdit"+n.product.id,"printessOptionValueMappingsEdit"+n.product.id,"printessProductTypeEdit"+n.product.id,"printessThemeEdit"+n.product.id],"")}};var t;return r.templateNameOrSaveToken||(t=u.getVariantByProductOptions(u.getCurrentProductOptionValues(n.product),n.product,!1))&&t.templateName&&(r.templateNameOrSaveToken=t.templateName),r},parseMergeTemplates:e=>{let o=null;if(e){try{var t=JSON.parse(e);o="string"==typeof t?[{templateName:t,mergeMode:"layout-snippet-no-repeat"}]:Array.isArray(t)?t:[t]}catch(t){o=[{templateName:e,mergeMode:"layout-snippet-no-repeat"}]}o&&o.forEach(t=>{t.mergeMode||(t.mergeMode="layout-snippet-no-repeat")})}return o},getProductByHandle:async function(e){if(u.productCache[e])return u.productCache[e];let o=null;return await fetch("/products/"+encodeURIComponent(e)+".js").then(function(t){return t.json()}).then(function(t){t={...t,name:t.title,options:t.options?t.options.map(t=>t.name):[]};u.productCache[e]=t,o=t}),o},formatMoney:(t,e)=>{"string"==typeof t&&(t=parseInt(t.replace(".","")));var o="",r=/\{\{\s*(\w+)\s*\}\}/;function n(t,e){return null==t?e:t}function i(t,e,o=null,r=null){return e=n(e,2),o=n(o,","),r=n(r,"."),isNaN(t)||null==t?"0":(t=(t/100).toFixed(e).split("."))[0].replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"+o)+(t[1]?r+t[1]:"")}switch(e.match(r)[1]){case"amount":o=i(t,2);break;case"amount_no_decimals":o=i(t,0);break;case"amount_with_comma_separator":o=i(t,2,".",",");break;case"amount_no_decimals_with_comma_separator":o=i(t,0,".",",")}return e.replace(r,o)},addOrRemoveTextField:(e,o,r,n)=>{if(Array.isArray(r))r.forEach(t=>{u.addOrRemoveTextField(e,o,t,n)});else{let t=document.getElementById(r);var i;n?(i="string"==typeof e?u.getAddToBasketForm(e):e,!t&&i&&((t=document.createElement("input")).setAttribute("id",r),t.setAttribute("name",o),t.setAttribute("type","hidden"),t.style.display="none",i.appendChild(t)),t&&t.setAttribute("value",n)):t&&t.remove()}},addNewItemToBasket:(t,e,o)=>{u.addOrRemoveTextField(u.productFormSelector,"properties[_printessSaveToken]","printessSaveTokenEdit"+t.product.id,e),u.addOrRemoveTextField(u.productFormSelector,"properties[_printessThumbnail]","printessThumbnailEdit"+t.product.id,o),u.addOrRemoveTextField(u.productFormSelector,"properties[_printessProductDefinitionId]","printessProductDefinitionIdEdit"+t.product.id,t.productDefinitionId),u.addOrRemoveTextField(u.productFormSelector,"properties[_printessOutputType]","printessOutputTypeEdit"+t.product.id,""+t.outputFormat||"pdf"),u.addOrRemoveTextField(u.productFormSelector,"properties[_printessDpi]","printessDpiEdit"+t.product.id,""+t.outputDpi||"300"),u.addOrRemoveTextField(u.productFormSelector,"properties[_printessOptionValueMappings]","printessOptionValueMappingsEdit"+t.product.id,""+t.optionValueMappings||""),u.addOrRemoveTextField(u.productFormSelector,"properties[_printessProductType]","printessProductTypeEdit"+t.product.id,t.productType||""),u.addOrRemoveTextField(u.productFormSelector,"properties[_printessTheme]","printessThemeEdit"+t.product.id,d.theme||"");e=u.getCurrentProductOptionValues(t.product),o=u.getProductOptionValuesForVariants(e,t.product);const r=u.getVariantByProductOptions(o,t.product,!0);if(r&&void 0!==r.productDefinitionId&&(-1===r.productDefinitionId||0<r.productDefinitionId)&&r){e=document.querySelectorAll("select[name='id']");if(e&&0<e.length){var n=e[0];n.value=r.id.toString(),n.setAttribute("value",r.id.toString());for(let t=0;t<n.options.length;++t)n.options[t].selected=n.options[t].getAttribute("value")===r.id.toString()}else{o=document.querySelectorAll("input[name='id']");o&&0<o.length&&o.forEach(t=>{t.setAttribute("value",r.id.toString())})}}t=document.querySelector(i);t&&t.click()},replaceBasketItem:(n,i,a)=>{var t=u.getProductOptionValuesForVariants(n.basketItemOptions,n.product);const p=u.getVariantByProductOptions(t,n.product,!0);fetch("/cart.js",{headers:{"Content-Type":"application/json"}}).then(t=>{t.json().then(t=>{var t=t["items"],o=t.find(t=>t.properties&&t.properties._printessSaveToken?t.properties&&t.properties._printessSaveToken===n.templateNameOrSaveToken:t.id===(n&&n.product&&n.product.variants&&0<n.product.variants.length?n.product.variants[0]:n.product).id);if(o){t=o["key"];let e={...o.properties};if(n.basketItemOptions)for(var r in n.basketItemOptions)o.properties&&o.properties.hasOwnProperty(r)&&n.basketItemOptions.hasOwnProperty(r)&&(e[r]=n.basketItemOptions[r]);e={...e,_printessSaveToken:i,_printessThumbnail:a,_printessProductDefinitionId:""+n.productDefinitionId,_printessOutputType:""+n.outputFormat||"pdf",_printessOptionValueMappings:n.optionValueMappings,_printessDpi:""+n.outputDpi||"300"},fetch("/cart/change.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t,quantity:0})}).then(t=>{fetch("/cart/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:[{id:p.id,quantity:void 0!==n.quantity&&1<n.quantity?n.quantity:1,properties:e}]})}).then(()=>{window.location.replace("/cart")})})}})})},readBasketItemQuantityInput:t=>{"".toString();var t=document.getElementById("printessCustomizeButton"+t.toString());return(t=t&&t.closest(".cart-item"))&&(t=t.querySelector("input.quantity__input"))?parseInt(t.getAttribute("value")):null}};window.printessShopifyEditor=u}return window.printessShopifyEditor};